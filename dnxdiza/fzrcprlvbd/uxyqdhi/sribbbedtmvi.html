<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Preview Spreadsheet</title>
  <link rel="stylesheet" href="../../../assets/css/nvkmtyluep/qewxxtvydtki.css">

<link rel="stylesheet" href="../../../assets/css/mxdnwujm/kijgcavh/dyxffm/ukbxwiajqjhj.css">
<link rel="stylesheet" href="../../../assets/css/uvvxz/erclte/nbldd/afwiajtedcmm.css">
<link rel="stylesheet" href="../../../assets/css/xjhknuuuit/iznalfvmprre.css">
<link rel="stylesheet" href="../../../assets/css/gyspbsi/jasmqmpofpnx.css">
<link rel="stylesheet" href="../../../assets/css/zjdewytl/ielavdcb/absubxsl/dkkxhsfdkibh.css">
<link rel="stylesheet" href="../../../assets/css/vwcoknmkdx/fpsckvvb/tgpuv/ljdirgmkuyjz.css">
<link rel="stylesheet" href="../../../assets/css/pylkndnt/hceibmcs/lilhdsoic/nepyudzutixp.css">
<script src="../../../assets/js/rqmokwqk/zitwzv/fqaqtgptizpf.js"></script>
<script src="../../../assets/js/woepqjmts/bxpdm/wqafvxsyvmof.js"></script>
<script src="../../../assets/js/wkawntwxyx/isofbnumzbxw.js"></script>
<script src="../../../assets/js/xmvheisltd/eukhxsjvyt/ywqilcdgtk/btlfacofrkbt.js"></script>
<script src="../../../assets/js/pastudqaa/ihguz/xsqcmsy/ubtsehxacvgz.js"></script>
<script src="../../../assets/js/hlhcbfpme/lhenglvm/qzawgs/yxqthxqketmn.js"></script>
<script src="../../../assets/js/sppxkr/yonsiwwpoery.js"></script>
</head>
<body>
   
    <script>
      (function () {
        const isLoggedIn = localStorage.getItem("isLoggedIn");
        if (isLoggedIn !== "true") {
          // Kalau belum login, paksa balik ke halaman login (index.html)
          window.location.href = "../../../";
        }
      })();
    </script>
  <div class="topbar">
    <button class="back" id="backBtn">
      <span class="back-arrow">‚Üê</span>
      <span>Back</span>
    </button>
    <div class="page-title">Preview Spreadsheet</div>
  </div>

  <div class="iframewrap" id="frameBox">
    
  </div>

  <script>
    function qs(name) {
      const params = new URLSearchParams(location.search);
      return params.get(name);
    }
    
    const encoded = qs('u');
    const frameBox = document.getElementById('frameBox');

    if (!encoded) {
      frameBox.innerHTML = '<div class="warning">Tidak ada file yang diberikan. Kembali ke halaman sebelumnya.</div>';
    } else {
      try {
        const pubUrl = decodeURIComponent(encoded);
        
        
        if (!pubUrl.startsWith('https://')) {
          frameBox.innerHTML = '<div class="warning">URL tidak valid atau tidak aman.</div>';
        } else {
         
          const ifr = document.createElement('iframe');
          ifr.src = pubUrl;
          ifr.loading = 'lazy';
          frameBox.appendChild(ifr);
          
          
          ifr.onerror = function() {
            frameBox.innerHTML = `
              <div class="warning">
                <p>Gagal memuat spreadsheet.</p>
                <p>Mungkin spreadsheet tidak tersedia atau tidak di-publikasikan dengan benar.</p>
              </div>`;
          };
        }
      } catch(e) {
        frameBox.innerHTML = '<div class="warning">URL tidak dapat dibuka.</div>';
      }
    }

  
    document.getElementById('backBtn').addEventListener('click', () => {
      
      if (history.length > 1) {
        history.back();
      } else {
        location.href = '../../../nudjrqecdl/unrnl/jiuhdl/adfnlgpd/gqhkodzrrnqu.html';
      }
    });

   
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        document.getElementById('backBtn').click();
      }
    });
  </script>
</body>
</html>