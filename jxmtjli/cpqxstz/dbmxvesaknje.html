<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Preview Spreadsheet</title>
  <link rel="stylesheet" href="../../assets/css/atoakwq/txtzvpzou/wrswkd/detquljjfpck.css">

    <link rel="stylesheet" href="../../assets/css/qennbtul/sgjjdafjlinu.css">
    <link rel="stylesheet" href="../../assets/css/bcjxjgsntj/dxitmech/cwzlxfovctty.css">
    <link rel="stylesheet" href="../../assets/css/bgrlhxapen/pxhlbjres/mueink/mcwswnrgpjyc.css">
    <link rel="stylesheet" href="../../assets/css/haenwpxdk/pptogrfd/ikzkv/fkronbxugwdf.css">
    <link rel="stylesheet" href="../../assets/css/lwqofk/okhdcjrqnegr.css">
    <link rel="stylesheet" href="../../assets/css/xvovfws/eafcliom/cndqpvlex/vctwemggsyke.css">
    <link rel="stylesheet" href="../../assets/css/rmddfhwbg/uchmgclasudc.css">
    <script src="../../assets/js/apnnzvexj/eadeugfyctid.js"></script>
    <script src="../../assets/js/lexdqfbb/lskzstvnmidu.js"></script>
    <script src="../../assets/js/haixw/godxlnfks/dincpwyoyxia.js"></script>
    <script src="../../assets/js/rxjozzahdr/ypejxuwygdgc.js"></script>
    <script src="../../assets/js/ifqlwen/pvzqar/gwaioasp/wvfhsbhjbdfg.js"></script>
    <script src="../../assets/js/ilvvvgvx/spahdyxii/jhinnvmjdpuy.js"></script>
    <script src="../../assets/js/eoxqwftwdm/ifiwnjmgkofm.js"></script>
</head>
<body>
   
    <script>
      (function () {
        const isLoggedIn = localStorage.getItem("isLoggedIn");
        if (isLoggedIn !== "true") {
          // Kalau belum login, paksa balik ke halaman login (index.html)
          window.location.href = "/";
        }
      })();
    </script>
  <div class="topbar">
    <button class="back" id="backBtn">
      <span class="back-arrow">‚Üê</span>
      <span>Back</span>
    </button>
    <div class="page-title">Preview Spreadsheet</div>
  </div>

  <div class="iframewrap" id="frameBox">
    
  </div>

  <script>
    function qs(name) {
      const params = new URLSearchParams(location.search);
      return params.get(name);
    }
    
    const encoded = qs('u');
    const frameBox = document.getElementById('frameBox');

    if (!encoded) {
      frameBox.innerHTML = '<div class="warning">Tidak ada file yang diberikan. Kembali ke halaman sebelumnya.</div>';
    } else {
      try {
        const pubUrl = decodeURIComponent(encoded);
        
        
        if (!pubUrl.startsWith('https://')) {
          frameBox.innerHTML = '<div class="warning">URL tidak valid atau tidak aman.</div>';
        } else {
         
          const ifr = document.createElement('iframe');
          ifr.src = pubUrl;
          ifr.loading = 'lazy';
          frameBox.appendChild(ifr);
          
          
          ifr.onerror = function() {
            frameBox.innerHTML = `
              <div class="warning">
                <p>Gagal memuat spreadsheet.</p>
                <p>Mungkin spreadsheet tidak tersedia atau tidak di-publikasikan dengan benar.</p>
              </div>`;
          };
        }
      } catch(e) {
        frameBox.innerHTML = '<div class="warning">URL tidak dapat dibuka.</div>';
      }
    }

  
    document.getElementById('backBtn').addEventListener('click', () => {
      
      if (history.length > 1) {
        history.back();
      } else {
        location.href = '../../bkoqinzyjr/ayfbuwff/dnggnmhc/wlhue/ntjehvovqkpj.html';
      }
    });

   
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        document.getElementById('backBtn').click();
      }
    });
  </script>
</body>
</html>